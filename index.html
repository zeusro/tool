<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½æ–‡æœ¬å¤„ç†å·¥å…·</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'gradient': 'gradient 15s ease infinite',
                    },
                    keyframes: {
                        gradient: {
                            '0%, 100%': {
                                'background-size': '200% 200%',
                                'background-position': 'left center'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'right center'
                            }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .dark-glass {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent animate-gradient">
                æ™ºèƒ½æ–‡æœ¬å¤„ç†å·¥å…·
            </h1>
            <p class="text-gray-300 text-lg">å¤šåŠŸèƒ½æ–‡æœ¬å¤„ç†ä¸è§£æå·¥å…·é›†</p>
        </header>


        <!-- Main Content Area -->
        <div class="max-w-6xl mx-auto">
            <!-- Input Section -->
            <div class="mb-6">
                <label class="block text-sm font-medium mb-2 text-gray-300">è¾“å…¥å†…å®¹</label>
                <textarea 
                    id="input" 
                    placeholder="æ™ºèƒ½è¯†åˆ«ï¼šè¾“å…¥ URLã€JSONã€UA æˆ– Base64ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶å¤„ç†..."
                    class="w-full h-40 px-4 py-3 rounded-lg dark-glass text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"
                ></textarea>
            </div>

            <!-- Action Buttons -->
            <div class="mb-6 flex gap-4 justify-center">
                <button onclick="processInput()" class="px-8 py-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                    âœ¨ å¤„ç†
                </button>
                <button onclick="clearAll()" class="px-8 py-3 bg-gradient-to-r from-gray-600 to-gray-700 rounded-lg font-semibold hover:from-gray-700 hover:to-gray-800 transition-all duration-300 transform hover:scale-105 shadow-lg">
                    ğŸ—‘ï¸ æ¸…ç©º
                </button>
                <button onclick="copyOutput()" class="px-8 py-3 bg-gradient-to-r from-blue-600 to-cyan-600 rounded-lg font-semibold hover:from-blue-700 hover:to-cyan-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
                    ğŸ“‹ å¤åˆ¶ç»“æœ
                </button>
            </div>

            <!-- Output Section -->
            <div>
                <label class="block text-sm font-medium mb-2 text-gray-300">è¾“å‡ºç»“æœ</label>
                <div id="output" class="w-full min-h-40 px-4 py-3 rounded-lg dark-glass text-white whitespace-pre-wrap break-words">
                    <p class="text-gray-400 text-center">å¤„ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Auto-detect input type and process accordingly
        function detectInputType(input) {
            const trimmed = input.trim();
            
            // 1. Check for URL (starts with http:// or https://, or contains URL patterns)
            if (trimmed.match(/^(https?|ftp):\/\//i)) {
                try {
                    new URL(trimmed);
                    return 'url';
                } catch (e) {
                    // Not a valid URL, continue checking
                }
            } else if (trimmed.includes('://') && trimmed.includes('.')) {
                try {
                    new URL(trimmed);
                    return 'url';
                } catch (e) {
                    // Not a valid URL, continue checking
                }
            } else if (trimmed.includes('?') && trimmed.includes('=') && trimmed.includes('.')) {
                // Looks like a URL with query string but no protocol
                try {
                    new URL('https://' + trimmed);
                    return 'url';
                } catch (e) {
                    // Not a valid URL, continue checking
                }
            }
            
            // 2. Check for JSON (must start with { or [)
            if ((trimmed.startsWith('{') && trimmed.endsWith('}')) ||
                (trimmed.startsWith('[') && trimmed.endsWith(']'))) {
                try {
                    JSON.parse(trimmed);
                    // Check if it's compressed (no spaces/newlines)
                    const isCompressed = !/\s/.test(trimmed);
                    return isCompressed ? 'json-compress' : 'json-format';
                } catch (e) {
                    // Not valid JSON, continue checking
                }
            }
            
            // 3. Check for UA (contains common browser/OS keywords and is long enough)
            if (trimmed.length > 20) {
                const uaKeywords = ['Mozilla', 'Chrome', 'Safari', 'Firefox', 'Edge', 'Opera', 
                                  'Windows', 'Macintosh', 'Linux', 'Android', 'iPhone', 'iPad',
                                  'Gecko', 'WebKit', 'Trident', 'Mobile'];
                const uaScore = uaKeywords.filter(keyword => 
                    trimmed.includes(keyword) || trimmed.toLowerCase().includes(keyword.toLowerCase())
                ).length;
                if (uaScore >= 3) {
                    return 'ua';
                }
            }
            
            // 4. Check for Base64 (only contains base64 characters, no JSON/URL patterns)
            const base64Regex = /^[A-Za-z0-9+/=\s]+$/;
            if (base64Regex.test(trimmed) && trimmed.length > 10) {
                // Must not start with {, [, http, or contain ://
                if (!trimmed.startsWith('{') && !trimmed.startsWith('[') && 
                    !trimmed.match(/^https?/i) && !trimmed.includes('://')) {
                    const cleanBase64 = trimmed.replace(/\s/g, '');
                    // Check if it looks like base64 (has padding or length is multiple of 4)
                    if (cleanBase64.length % 4 === 0 || cleanBase64.endsWith('=')) {
                        return 'base64';
                    }
                }
            }
            
            // 5. Default: treat as text to encode to base64
            return 'base64';
        }

        // Process input with auto-detection
        function processInput() {
            const input = document.getElementById('input').value.trim();
            const outputDiv = document.getElementById('output');
            
            if (!input) {
                outputDiv.innerHTML = '<p class="text-red-400 text-center">è¯·è¾“å…¥å†…å®¹ï¼</p>';
                return;
            }

            // Auto-detect input type
            const detectedType = detectInputType(input);
            let result = '';
            let toolName = '';
            
            try {
                switch(detectedType) {
                    case 'url':
                        toolName = 'ğŸ”— URL è§£æ';
                        result = processURL(input);
                        break;
                    case 'json-compress':
                        toolName = 'ğŸ“¦ JSON å‹ç¼©/è§£å‹';
                        result = processJSONCompress(input);
                        break;
                    case 'json-format':
                        toolName = 'ğŸ“„ JSON æ ¼å¼åŒ–';
                        result = processJSONFormat(input);
                        break;
                    case 'ua':
                        toolName = 'ğŸŒ UA åˆ†æ';
                        result = processUA(input);
                        break;
                    case 'base64':
                        toolName = 'ğŸ” Base64 å·¥å…·';
                        result = processBase64(input);
                        break;
                    default:
                        toolName = 'ğŸ” Base64 å·¥å…·';
                        result = processBase64(input);
                }
                
                // Add detected tool indicator
                const toolIndicator = `<div class="mb-3 text-sm text-gray-400 text-center">
                    <span class="px-3 py-1 bg-purple-500 bg-opacity-30 rounded-full">${toolName}</span>
                </div>`;
                
                outputDiv.innerHTML = toolIndicator + result;
            } catch (error) {
                outputDiv.innerHTML = `<p class="text-red-400">é”™è¯¯: ${error.message}</p>`;
            }
        }

        // URL Parser
        function processURL(url) {
            try {
                // Decode URL
                let decoded = decodeURIComponent(url);
                // Add protocol if missing
                if (!decoded.match(/^[a-zA-Z][a-zA-Z\d+\-.]*:/)) {
                    decoded = 'https://' + decoded;
                }
                const urlObj = new URL(decoded);
                
                let html = '<div class="space-y-4">';
                
                // Basic URL info
                html += '<div class="bg-purple-500 bg-opacity-20 p-4 rounded-lg">';
                html += '<h3 class="text-lg font-semibold mb-2 text-purple-300">URL åŸºæœ¬ä¿¡æ¯</h3>';
                html += `<p><span class="text-gray-400">åè®®:</span> <span class="text-cyan-400">${urlObj.protocol}</span></p>`;
                html += `<p><span class="text-gray-400">ä¸»æœº:</span> <span class="text-cyan-400">${urlObj.hostname}</span></p>`;
                html += `<p><span class="text-gray-400">ç«¯å£:</span> <span class="text-cyan-400">${urlObj.port || 'é»˜è®¤'}</span></p>`;
                html += `<p><span class="text-gray-400">è·¯å¾„:</span> <span class="text-cyan-400">${urlObj.pathname}</span></p>`;
                html += `<p><span class="text-gray-400">å“ˆå¸Œ:</span> <span class="text-cyan-400">${urlObj.hash || 'æ— '}</span></p>`;
                html += '</div>';
                
                // Query parameters
                const params = urlObj.searchParams;
                if (params.toString()) {
                    html += '<div class="bg-blue-500 bg-opacity-20 p-4 rounded-lg">';
                    html += '<h3 class="text-lg font-semibold mb-3 text-blue-300">Query String å‚æ•°</h3>';
                    html += '<div class="grid grid-cols-1 md:grid-cols-2 gap-3">';
                    
                    params.forEach((value, key) => {
                        html += '<div class="bg-black bg-opacity-30 p-3 rounded border border-gray-600">';
                        html += `<p class="text-yellow-400 font-mono text-sm mb-1">${key}</p>`;
                        html += `<p class="text-green-400 break-all">${decodeURIComponent(value)}</p>`;
                        html += '</div>';
                    });
                    
                    html += '</div>';
                    html += '</div>';
                } else {
                    html += '<div class="bg-gray-500 bg-opacity-20 p-4 rounded-lg">';
                    html += '<p class="text-gray-400">æœªæ‰¾åˆ° Query String å‚æ•°</p>';
                    html += '</div>';
                }
                
                html += '</div>';
                return html;
            } catch (error) {
                return `<p class="text-red-400">URL è§£æé”™è¯¯: ${error.message}</p>`;
            }
        }

        // JSON Compress/Decompress
        function processJSONCompress(jsonStr) {
            try {
                // Try to parse as JSON first
                let jsonObj = JSON.parse(jsonStr);
                
                // Check if it's already compressed (no spaces)
                const isCompressed = !/\s/.test(jsonStr.trim());
                
                if (isCompressed) {
                    // Decompress (format)
                    return `<div class="bg-green-500 bg-opacity-20 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-2 text-green-300">è§£å‹ç¼©åçš„ JSON</h3>
                        <pre class="bg-black bg-opacity-40 p-4 rounded overflow-x-auto text-sm">${JSON.stringify(jsonObj, null, 2)}</pre>
                    </div>`;
                } else {
                    // Compress
                    const compressed = JSON.stringify(jsonObj);
                    return `<div class="bg-orange-500 bg-opacity-20 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-2 text-orange-300">å‹ç¼©åçš„ JSON</h3>
                        <pre class="bg-black bg-opacity-40 p-4 rounded overflow-x-auto text-sm break-all">${compressed}</pre>
                    </div>`;
                }
            } catch (error) {
                return `<p class="text-red-400">JSON å¤„ç†é”™è¯¯: ${error.message}</p>`;
            }
        }

        // JSON Format
        function processJSONFormat(jsonStr) {
            try {
                const jsonObj = JSON.parse(jsonStr);
                const formatted = JSON.stringify(jsonObj, null, 2);
                
                return `<div class="bg-indigo-500 bg-opacity-20 p-4 rounded-lg">
                    <h3 class="text-lg font-semibold mb-2 text-indigo-300">æ ¼å¼åŒ–åçš„ JSON</h3>
                    <pre class="bg-black bg-opacity-40 p-4 rounded overflow-x-auto text-sm">${formatted}</pre>
                </div>`;
            } catch (error) {
                return `<p class="text-red-400">JSON æ ¼å¼åŒ–é”™è¯¯: ${error.message}</p>`;
            }
        }

        // UA Analyzer
        function processUA(ua) {
            const info = {
                browser: 'æœªçŸ¥',
                browserVersion: 'æœªçŸ¥',
                os: 'æœªçŸ¥',
                osVersion: 'æœªçŸ¥',
                device: 'æœªçŸ¥',
                engine: 'æœªçŸ¥',
                mobile: false,
                tablet: false,
                desktop: false
            };

            // Browser detection
            if (ua.includes('Chrome') && !ua.includes('Edg') && !ua.includes('OPR')) {
                const match = ua.match(/Chrome\/([\d.]+)/);
                info.browser = 'Chrome';
                info.browserVersion = match ? match[1] : 'æœªçŸ¥';
            } else if (ua.includes('Firefox')) {
                const match = ua.match(/Firefox\/([\d.]+)/);
                info.browser = 'Firefox';
                info.browserVersion = match ? match[1] : 'æœªçŸ¥';
            } else if (ua.includes('Safari') && !ua.includes('Chrome')) {
                const match = ua.match(/Version\/([\d.]+).*Safari/);
                info.browser = 'Safari';
                info.browserVersion = match ? match[1] : 'æœªçŸ¥';
            } else if (ua.includes('Edg')) {
                const match = ua.match(/Edg\/([\d.]+)/);
                info.browser = 'Edge';
                info.browserVersion = match ? match[1] : 'æœªçŸ¥';
            } else if (ua.includes('OPR')) {
                const match = ua.match(/OPR\/([\d.]+)/);
                info.browser = 'Opera';
                info.browserVersion = match ? match[1] : 'æœªçŸ¥';
            }

            // OS detection
            if (ua.includes('Windows')) {
                info.os = 'Windows';
                const match = ua.match(/Windows NT ([\d.]+)/);
                if (match) {
                    const version = match[1];
                    const versions = {
                        '10.0': '10/11',
                        '6.3': '8.1',
                        '6.2': '8',
                        '6.1': '7'
                    };
                    info.osVersion = versions[version] || version;
                }
                info.desktop = true;
            } else if (ua.includes('Mac OS X') || ua.includes('Macintosh')) {
                info.os = 'macOS';
                const match = ua.match(/Mac OS X ([\d_]+)/);
                if (match) {
                    info.osVersion = match[1].replace(/_/g, '.');
                }
                info.desktop = true;
            } else if (ua.includes('Linux')) {
                info.os = 'Linux';
                info.desktop = true;
            } else if (ua.includes('Android')) {
                info.os = 'Android';
                const match = ua.match(/Android ([\d.]+)/);
                info.osVersion = match ? match[1] : 'æœªçŸ¥';
                info.mobile = true;
            } else if (ua.includes('iPhone') || ua.includes('iPad')) {
                info.os = 'iOS';
                const match = ua.match(/OS ([\d_]+)/);
                if (match) {
                    info.osVersion = match[1].replace(/_/g, '.');
                }
                if (ua.includes('iPad')) {
                    info.tablet = true;
                } else {
                    info.mobile = true;
                }
            }

            // Engine detection
            if (ua.includes('Gecko')) {
                info.engine = 'Gecko';
            } else if (ua.includes('WebKit')) {
                info.engine = 'WebKit';
            } else if (ua.includes('Trident')) {
                info.engine = 'Trident';
            }

            // Device type
            if (ua.includes('Mobile')) {
                info.mobile = true;
            }

            let html = '<div class="space-y-4">';
            html += '<div class="bg-cyan-500 bg-opacity-20 p-4 rounded-lg">';
            html += '<h3 class="text-lg font-semibold mb-3 text-cyan-300">å®¢æˆ·ç«¯ä¿¡æ¯åˆ†æ</h3>';
            html += '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
            
            html += `<div class="bg-black bg-opacity-30 p-3 rounded">
                <p class="text-gray-400 text-sm mb-1">æµè§ˆå™¨</p>
                <p class="text-cyan-400 font-semibold">${info.browser} ${info.browserVersion}</p>
            </div>`;
            
            html += `<div class="bg-black bg-opacity-30 p-3 rounded">
                <p class="text-gray-400 text-sm mb-1">æ“ä½œç³»ç»Ÿ</p>
                <p class="text-green-400 font-semibold">${info.os} ${info.osVersion}</p>
            </div>`;
            
            html += `<div class="bg-black bg-opacity-30 p-3 rounded">
                <p class="text-gray-400 text-sm mb-1">æ¸²æŸ“å¼•æ“</p>
                <p class="text-yellow-400 font-semibold">${info.engine}</p>
            </div>`;
            
            html += `<div class="bg-black bg-opacity-30 p-3 rounded">
                <p class="text-gray-400 text-sm mb-1">è®¾å¤‡ç±»å‹</p>
                <p class="text-purple-400 font-semibold">${info.mobile ? 'ğŸ“± ç§»åŠ¨è®¾å¤‡' : info.tablet ? 'ğŸ“± å¹³æ¿è®¾å¤‡' : 'ğŸ’» æ¡Œé¢è®¾å¤‡'}</p>
            </div>`;
            
            html += '</div>';
            html += '</div>';
            
            html += '<div class="bg-gray-500 bg-opacity-20 p-4 rounded-lg mt-4">';
            html += '<h3 class="text-lg font-semibold mb-2 text-gray-300">åŸå§‹ UA</h3>';
            html += `<pre class="bg-black bg-opacity-40 p-3 rounded text-xs break-all">${ua}</pre>`;
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        // Base64 Tools
        function processBase64(input) {
            let html = '<div class="space-y-4">';
            
            try {
                // Check if it's a valid base64 string
                const base64Regex = /^[A-Za-z0-9+/=]+$/;
                const isBase64 = base64Regex.test(input.trim()) && input.trim().length > 0;
                
                if (isBase64) {
                    // Try to decode
                    try {
                        const decoded = atob(input.trim());
                        
                        // Check if it's an image (common image headers)
                        const imageHeaders = {
                            '/9j/': 'JPEG',
                            'iVBORw0KGgo': 'PNG',
                            'R0lGODlh': 'GIF',
                            'UklGR': 'WebP',
                            'Qk0=': 'BMP'
                        };
                        
                        let isImage = false;
                        let imageType = '';
                        for (const [header, type] of Object.entries(imageHeaders)) {
                            if (input.trim().startsWith(header)) {
                                isImage = true;
                                imageType = type;
                                break;
                            }
                        }
                        
                        if (isImage) {
                            html += '<div class="bg-pink-500 bg-opacity-20 p-4 rounded-lg">';
                            html += '<h3 class="text-lg font-semibold mb-2 text-pink-300">Base64 å›¾ç‰‡</h3>';
                            html += `<p class="text-gray-300 mb-2">å›¾ç‰‡ç±»å‹: ${imageType}</p>`;
                            html += `<img src="data:image/${imageType.toLowerCase()};base64,${input.trim()}" class="max-w-full h-auto rounded-lg border border-gray-600" alt="Base64 Image">`;
                            html += '</div>';
                        } else {
                            html += '<div class="bg-green-500 bg-opacity-20 p-4 rounded-lg">';
                            html += '<h3 class="text-lg font-semibold mb-2 text-green-300">è§£ç åçš„å†…å®¹</h3>';
                            html += `<pre class="bg-black bg-opacity-40 p-4 rounded overflow-x-auto text-sm break-all">${decoded}</pre>`;
                            html += '</div>';
                        }
                    } catch (e) {
                        html += '<div class="bg-yellow-500 bg-opacity-20 p-4 rounded-lg">';
                        html += '<p class="text-yellow-300">Base64 å­—ç¬¦ä¸²æ ¼å¼æ­£ç¡®ï¼Œä½†è§£ç å¤±è´¥</p>';
                        html += '</div>';
                    }
                } else {
                    // Encode to base64
                    const encoded = btoa(input);
                    html += '<div class="bg-blue-500 bg-opacity-20 p-4 rounded-lg">';
                    html += '<h3 class="text-lg font-semibold mb-2 text-blue-300">ç¼–ç åçš„ Base64</h3>';
                    html += `<pre class="bg-black bg-opacity-40 p-4 rounded overflow-x-auto text-sm break-all">${encoded}</pre>`;
                    html += '</div>';
                }
            } catch (error) {
                html += `<div class="bg-red-500 bg-opacity-20 p-4 rounded-lg">`;
                html += `<p class="text-red-300">é”™è¯¯: ${error.message}</p>`;
                html += '</div>';
            }
            
            html += '</div>';
            return html;
        }

        // Clear all
        function clearAll() {
            document.getElementById('input').value = '';
            document.getElementById('output').innerHTML = '<p class="text-gray-400 text-center">å¤„ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...</p>';
        }

        // Copy output
        function copyOutput() {
            const output = document.getElementById('output');
            const text = output.innerText || output.textContent;
            
            if (text && !text.includes('å¤„ç†ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ')) {
                navigator.clipboard.writeText(text).then(() => {
                    const btn = event.target;
                    const originalText = btn.textContent;
                    btn.textContent = 'âœ… å·²å¤åˆ¶';
                    btn.classList.add('bg-green-600');
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.classList.remove('bg-green-600');
                    }, 2000);
                }).catch(err => {
                    alert('å¤åˆ¶å¤±è´¥: ' + err);
                });
            }
        }

    </script>
</body>
</html>